<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Shipment Tracking</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    input, button { padding: 8px; margin: 5px 0; }
    .shipment { border: 1px solid #ccc; padding: 10px; margin-top: 10px; }
  </style>
</head>
<body>
  <h2>Tracking Shipment</h2>
  <input type="text" id="searchInput" placeholder="Masukkan Nomor BL">
  <button onclick="searchShipment()">Cari</button>
  <div id="results"></div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
    import { getFirestore, collection, query, where, getDocs } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBwIvGNogDk6nKCCcoWxmnvex4pbSIR07g",
      authDomain: "track-and-trace-ca19a.firebaseapp.com",
      projectId: "track-and-trace-ca19a",
      storageBucket: "track-and-trace-ca19a.appspot.com",
      messagingSenderId: "264766950053",
      appId: "1:264766950053:web:b871670f2ab2c10d0f1b4c"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    async function searchShipment() {
      const searchValue = document.getElementById('searchInput').value.trim();
      const resultsDiv = document.getElementById('results');
      resultsDiv.innerHTML = "Mencari...";

      const q = query(collection(db, "shipments"), where("billOfLading", "==", searchValue));

      let found = false;
      const querySnapshot = await getDocs(q);
      querySnapshot.forEach((doc) => {
        const data = doc.data();
        resultsDiv.innerHTML = `
          <div class="shipment">
            <strong>Bill of Lading:</strong> ${data.billOfLading} <br>
            <strong>Vessel / Voyage:</strong> ${data.vesselVoyage} <br>
            <strong>ETA:</strong> ${data.eta} <br>
            <strong>Port of Transit:</strong> ${data.portTransit} <br>
            <strong>Connecting Vessel:</strong> ${data.connectingVessel} <br>
            <strong>ETD:</strong> ${data.etd} <br>
            <strong>ETA POD:</strong> ${data.etaPod} <br>
            <strong>Port of Destination:</strong> ${data.portDestination} <br>
            <strong>DO Release Date:</strong> ${data.doReleaseDate || '-'} <br>
            <strong>Cargo Release Date:</strong> ${data.cargoReleaseDate || '-'}
          </div>
        `;
        found = true;
      });

      if (!found) resultsDiv.innerHTML = "Data tidak ditemukan.";
    }
    window.searchShipment = searchShipment;
  </script>
</body>
</html>
